# 4장 데이터 링크 계층 : 랜에서 데이터 전송하기

---

## LESSON 13 MAC 주소의 구조

> 랜 카드를 제조할 때 정해지는 물리적인 주소에 대해서 알아보자.

### 1. MAC 주소란?

> 위키백과 : [MAC 주소](https://ko.wikipedia.org/wiki/MAC_%EC%A3%BC%EC%86%8C)
>
> MAC 주소(Media Access Control Address)는 네트워크 세그먼트의 데이터 링크 계층에서 통신을 위한 네트워크 인터페이스에 할당된 고유 식별자이다.
>
> MAC 주소는 이더넷과 와이파이를 포함한 대부분의 IEEE 802 네트워크 기술에 네트워크 주소로 사용된다. 논리적으로 MAC 주소는 매체 접근 제어 프로토콜이라는 OSI 모델의 하위 계층에서 사용된다.

![MAC-48 Address.svg](4장_13_MAC_주소의_구조.assets/1024px-MAC-48_Address.svg.png)



랜 카드는 비트열( 0 과 1 )을 전기 신호로 변환한다고 했다. 이러한 랜 카드에는 **MAC 주소**라는 번호가 정해져 있다. 제조할 때 새겨지기 때문에 **물리 주소**라고도 부르는데, **전 세계에서 유일한 번호**로 할당되어 있다.

MAC 주소는 48비트 숫자로 구성되어 있다. 그중 앞쪽 24 비트는 랜 카드를 만든 제조사 번호고 뒤쪽 24 비트는 제조사가 랜 카드에 붙인 일련번호이다.

#### ex )  00 - 23 - AE   -   D9 - 7A - 9A

​	(랜 카드 제조사) - (제조사 일련번호)



MAC 주소를 사용한 통신에 대해 알아보자. OSI 모델(7계층)이나 TCP/IP 모델(4계층)을 떠올려 보면 각 계층에서 **헤더**를 붙이는 것을 배웠었다. OSI 모델에서는 데이터 링크 계층에 해당하고 TCP/IP 모델에서는 네트워크 계층에 해당하는데, 이 계층에서 **이더넷 헤더**와 **트레일러**를 붙인다.

<u>이더넷 헤더</u>는 목적지의 MAC 주소(6byte), 출발지 MAC 주소(6byte), 유형(2byte) 이렇게 총 14byte로 구성되어 있다.

* 이더넷 헤더 구조

| 목적지 MAC 주소 | 출발지 MAC 주소 |   유형   |
| :-------------: | :-------------: | :------: |
|    (6 byte)     |    (6 byte)     | (2 byte) |





이더넷 유형은 이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타낸다. 다음 표에 나와 있는 프로토콜을 식별하는 16진수 번호가 들어간다.

* 프로토콜을 식별하는 유형 번호 (16진수)

| 유형 번호 |      프로토콜      |
| :-------: | :----------------: |
|   0800    |        IPv4        |
|   0806    |        ARP         |
|   8035    |        RARP        |
|   814C    | SNMP over Ethernet |
|   86DD    |        IPv6        |



유형 번호를 기억할 필요는 없지만 유형에 **프로토콜 종류를 식별하는 번호**가 들어간다는 것만 기억하면 될 것 같다.

이더넷 헤더 외에 데이터 뒤에 추가하는 것을 트레일러라고 한다. 이것을 **FCS**(Frame Check Sequence)라고도 하는데, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용한다.

이처럼 이더넷 헤더와 트레일러가 추가된 데이터를 **프레임**이라고 한다. => **데이터 링크 계층에서 데이터 사이에 추가되는 헤더+데이터+트레일러 = 프레임**

프레임은 네트워크를 통해 프레임이 전송되는 것이다. 

* ## 허브로 연결된 컴퓨터가 데이터를 전송하는 과정

  1. 컴퓨터 1에서 컴퓨터 3으로 데이터를 전송하고자 함. (컴퓨터는 1~5까지 허브로 연결되어 있음)
  2. 컴퓨터 1은 이더넷 헤더에 데이터의 목적지인 컴퓨터 3의 MAC주소(목적지)와 자신의 MAC주소(출발지) 정보를 넣고 데이터를 전송한다.
  3. 컴퓨터 1에서 캡슐화가 진행된다. (데이터 앞부분에 전송하는 데 필요한 정보를 붙여서 다음 계층으로 보내는 과정 => 헤더)
  4. 데이터 링크 계층에서 데이터에 이더넷 헤더와 트레일러를 추가하여 **프레임**을 만든다. (중요!!!)
  5. 물리계층에서 이 프레임 비트열을 **전기신호**로 변환하여 네트워크를 통해 전송
  6.  컴퓨터 1이 보낸 데이터를 컴퓨터 1 허브 포트로 수신하고 2~5번 포트로 전송함
  7. 컴퓨터 2,4,5는 목적지 MAC주소가 자신의 MAC 주소와 다르기 때문에 데이터를 파기함
  8. 반면 컴퓨터 3은 자신의 MAC 주소가 컴퓨터 1이 보낸 목적지 MAC주소와 같으므로 데이터를 수신함.
  9. 컴퓨터 3은 Decapsulation(역캡슐화) 과정을 거치며 데이터를 수신함

컴퓨터 1과 2가 동시에 컴퓨터 3에 데이터를 전송하게 되면 충돌을 방지하기 위해 CSMA/CD 방식이 사용된다.



* LESSON 13 정리
  * MAC 주소는 48비트 숫자로 구성되어 있다. 그중 앞쪽 24비트는 랜 카드를 만든 제조사 번호고, 뒤쪽 24비트는 제조사가 랜 카드에 붙인 일련번호다.
  * 이더넷 헤더는 목적지 MAC 주소(6byte), 출발지 MAC 주소 (6byte), 유형(2byte)으로 총 14byte로 구성된다.
  * 데이터 링크 계층에서 데이터 뒤에 추가하는 것을 트레일러라고 한다.